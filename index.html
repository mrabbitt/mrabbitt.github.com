<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="description" content="One is 3">
    <meta name="viewport" content="width=device-width">
    <title>①ne is 3</title>

    
            <link href="assets/css/bootstrap.min.css" rel="stylesheet" type="text/css">
            <link href="assets/css/bootstrap-responsive.min.css" rel="stylesheet" type="text/css">
        <link href="assets/css/rst.css" rel="stylesheet" type="text/css">
        <link href="assets/css/code.css" rel="stylesheet" type="text/css">
        <link href="assets/css/colorbox.css" rel="stylesheet" type="text/css">
        <link href="assets/css/theme.css" rel="stylesheet" type="text/css">
            <link href="assets/css/custom.css" rel="stylesheet" type="text/css">

    
            <link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">

      <link rel="canonical" href="http://oneis3.com/index.html">



    
        <!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]-->

    




</head>
<body>

<!-- Menubar -->

<div class="navbar navbar-fixed-top" id="navbar">
    <div class="navbar-inner">
        <div class="container">

        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </a>

            <a class="brand" href=".">

                <span id="blog-title">①ne is 3</span>
            </a>
            <!-- Everything you want hidden at 940px or less, place within here -->
            <div class="nav-collapse collapse">
                <ul class="nav">
                    
                <li>
<a href="archive.html">Archives</a>
                </li>
<li>
<a href="categories/index.html">Tags</a>
                </li>
<li>
<a href="stories/about.html">About</a>
                </li>
<li>
<a href="rss.xml">RSS</a>

                    
                </li>
</ul>
                    
<!-- Custom search -->
<form method="get" id="search" action="http://duckduckgo.com/" class="navbar-form pull-right">
    <input type="hidden" name="sites" value="http://oneis3.com/">
    <input type="hidden" name="k8" value="#444444">
    <input type="hidden" name="k9" value="#D51920">
    <input type="hidden" name="kt" value="h">
    <input type="text" name="q" maxlength="255" placeholder="Search…" class="span2" style="margin-top: 4px;">
    <input type="submit" value="DuckDuckGo Search" style="visibility: hidden;">
</form>
<!-- End of custom search -->

                <ul class="nav pull-right">
                
                
                
                </ul>
            </div>
        </div>
    </div>
</div>
<!-- End of Menubar -->
<div class="container-fluid" id="container-fluid">
    <!--Body content-->
    <div class="row-fluid">
    <div class="span2"></div>
    <div class="span8">
    
    
<div class="postindex">
    <article class="h-entry post-text">
    <header>
        <h1 class="p-name entry-title"><a href="posts/using-ddclient-for-dynamic-dns-on-amazon-ec2.html" class="u-url">Using DDclient for dynamic DNS on Amazon EC2</a></h1>
        <div class="metadata">
            <p class="dateline">Posted: <a href="posts/using-ddclient-for-dynamic-dns-on-amazon-ec2.html" rel="bookmark"><time class="published dt-published" datetime="2014-07-21T19:30:50+00:00" itemprop="datePublished" title="Publication date">2014-07-21 19:30</time></a></p>
        </div>
    </header>
    <div class="e-content entry-content">
    <p>When using Amazon EC2, IP addresses of your instances are assigned dynamically when launched.  If you are bring up and down instances frequently, it can be helpful to use a <a href="https://en.wikipedia.org/wiki/Dynamic_DNS">dynamic DNS</a> service so you can use a consistent hostname for your instance, event if it's IP address changes.</p>
<p><a href="http://sourceforge.net/p/ddclient/wiki/">DDclient</a> is a command line tool which works with a variety of dynamic DNS providers and is available pre-packaged on many Linux distributions (e.g. <code>apt-get install ddclient</code> on Ubuntu 14.04). DDclient can use <a href="http://sourceforge.net/p/ddclient/wiki/routers/">various methods</a> to look up the IP to use.  In this case, I want DDclient to use the EC instance's external IP address.  One method is to look up the IP from a specified web page, usually used with a site like <a href="http://www.whatismyip.com/">whatismyip.com</a> or <a href="http://www.checkip.org/">checkip.org</a>.</p>
<p>On an EC2 instance, we have another option: <a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AESDG-chapter-instancedata.html">Instance Metadata</a>.  You can fetch all kinds of useful metadata about an EC2 instance using a REST API served from <code>http://169.254.169.254/latest/meta-data/</code>.  To retreive the public IP address (IPv4) of a running EC2 instance, fetch <code>http://169.254.169.254/latest/meta-data/public-ipv4</code> from that instance.  To use this with DDclient, include the following line in your DDclient config file:</p>
<pre class="code literal-block"><span class="n">use</span><span class="o">=</span><span class="n">web</span><span class="p">,</span> <span class="n">web</span><span class="o">=</span><span class="n">http</span><span class="o">:</span><span class="c1">//169.254.169.254/latest/meta-data/public-ipv4</span>
</pre>
    </div>
    </article>
    <article class="h-entry post-text">
    <header>
        <h1 class="p-name entry-title"><a href="posts/fun-with-sikuli-and-baldurs-gate.html" class="u-url">Fun with Sikuli and Baldur's Gate</a></h1>
        <div class="metadata">
            <p class="dateline">Posted: <a href="posts/fun-with-sikuli-and-baldurs-gate.html" rel="bookmark"><time class="published dt-published" datetime="2013-09-16T00:55:24+00:00" itemprop="datePublished" title="Publication date">2013-09-16 00:55</time></a></p>
        </div>
    </header>
    <div class="e-content entry-content">
    <p>A few months ago I was playing <a href="http://www.baldursgate.com">Baldur's Gate: Enhanced Edition (BGEE)</a>, and going through the character creation process.  The game chooses the character's initial statistics by simulated random dice rolls.  You can re-distribute points between different attributes as you desire, but you can only increase the total number of points by re-rolling.  You can re-roll as many times as you want, hoping to get a higher total number of points.  You can also "store" and "recall" a single roll.</p>
<p>The lazy programmer in me saw this as an a task begging for automation.</p>
<p>I spent the next several hours developing a <a href="http://sikuli.org">Sikuli</a> script which automates the process of re-rolling until a desired total roll is reached.  I've finally gotten around to cleaning up the code and releasing it on github as <a href="https://github.com/mrabbitt/BGEE_Sikuli_auto_roller">BGEE_Sikuli_auto_roller</a>.</p>
<p>Here's a video demo (painfully edited in iMovie) of <code>BGEE_Sikuli_auto_roller</code> in action:</p>
<iframe width="420" height="315" src="//www.youtube.com/embed/K-0nRvz3z4I" frameborder="0" allowfullscreen></iframe>

<p>Happy dungeon/code hacking!</p>
    </div>
    </article>
    <article class="h-entry post-text">
    <header>
        <h1 class="p-name entry-title"><a href="posts/python-markdown-extension-for-inline-gist.html" class="u-url">Python Markdown Extension for Inline Gist</a></h1>
        <div class="metadata">
            <p class="dateline">Posted: <a href="posts/python-markdown-extension-for-inline-gist.html" rel="bookmark"><time class="published dt-published" datetime="2013-03-04T00:23:36+00:00" itemprop="datePublished" title="Publication date">2013-03-04 00:23</time></a></p>
        </div>
    </header>
    <div class="e-content entry-content">
    <p>As discussed in <a href="https://groups.google.com/d/topic/nikola-discuss/ScaJGcTGBBY/discussion">this thread on the Nikola forum</a>, I'd wanted a way add a custom inline "gist" directive to Nikola which I could use in my markdown posts to include the full contents of the gist in a <code>&lt;noscript&gt;</code> tag.  This makes gist contents available in the site RSS feed and when viewing the site with Javascript disabled.  Here's a gist (of course) with the Python Markdown extension that makes this possible:</p>
<p>
</p>
<div class="gist">
<script src="https://gist.github.com/5080027.js"></script>
<noscript>
<pre># -*- coding: utf-8 -*-
#
# Copyright (c) 2013 Michael Rabbitt.
#
# Permission is hereby granted, free of charge, to any person obtaining a
# copy of this software and associated documentation files (the
# "Software"), to deal in the Software without restriction, including
# without limitation the rights to use, copy, modify, merge, publish,
# distribute, sublicense, and/or sell copies of the Software, and to
# permit persons to whom the Software is furnished to do so, subject to
# the following conditions:
#
# The above copyright notice and this permission notice shall be included
# in all copies or substantial portions of the Software.
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
# OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
# MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
# IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
# CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
# TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
# SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
#
# Warning: URL formats of "raw" gists are undocummented and subject to change.
# See also:  http://developer.github.com/v3/gists/
#
# Inspired by "[Python] reStructuredText GitHub Gist directive"
# (https://gist.github.com/brianhsu/1407759), public domain by Brian Hsu
'''
Extension to Python Markdown for Embedded Gists (gist.github.com)

Basic Example:

    &gt;&gt;&gt; import markdown
    &gt;&gt;&gt; text = """
    ... Text of the gist:
    ... [:gist: 4747847]
    ... """
    &gt;&gt;&gt; html = markdown.markdown(text, ['gist'])
    &gt;&gt;&gt; print(html)
    &lt;p&gt;Text of the gist:
    &lt;div class="gist"&gt;
    &lt;script src="https://gist.github.com/4747847.js"&gt;&lt;/script&gt;
    &lt;noscript&gt;
    &lt;pre&gt;import this&lt;/pre&gt;
    &lt;/noscript&gt;
    &lt;/div&gt;
    &lt;/p&gt;

Example with filename:

    &gt;&gt;&gt; import markdown
    &gt;&gt;&gt; text = """
    ... Text of the gist:
    ... [:gist: 4747847 zen.py]
    ... """
    &gt;&gt;&gt; html = markdown.markdown(text, ['gist'])
    &gt;&gt;&gt; print(html)
    &lt;p&gt;Text of the gist:
    &lt;div class="gist"&gt;
    &lt;script src="https://gist.github.com/4747847.js?file=zen.py"&gt;&lt;/script&gt;
    &lt;noscript&gt;
    &lt;pre&gt;import this&lt;/pre&gt;
    &lt;/noscript&gt;
    &lt;/div&gt;
    &lt;/p&gt;

Example using reStructuredText syntax:

    &gt;&gt;&gt; import markdown
    &gt;&gt;&gt; text = """
    ... Text of the gist:
    ... .. gist:: 4747847 zen.py
    ... """
    &gt;&gt;&gt; html = markdown.markdown(text, ['gist'])
    &gt;&gt;&gt; print(html)
    &lt;p&gt;Text of the gist:
    &lt;div class="gist"&gt;
    &lt;script src="https://gist.github.com/4747847.js?file=zen.py"&gt;&lt;/script&gt;
    &lt;noscript&gt;
    &lt;pre&gt;import this&lt;/pre&gt;
    &lt;/noscript&gt;
    &lt;/div&gt;
    &lt;/p&gt;

Error Case: non-existent Gist ID:

    &gt;&gt;&gt; import markdown
    &gt;&gt;&gt; text = """
    ... Text of the gist:
    ... [:gist: 0]
    ... """
    &gt;&gt;&gt; html = markdown.markdown(text, ['gist'])
    &gt;&gt;&gt; print(html)
    &lt;p&gt;Text of the gist:
    &lt;div class="gist"&gt;
    &lt;script src="https://gist.github.com/0.js"&gt;&lt;/script&gt;
    &lt;noscript&gt;&lt;!-- WARNING: Received a 404 response from Gist URL: \
    https://gist.githubusercontent.com/raw/0 --&gt;&lt;/noscript&gt;
    &lt;/div&gt;
    &lt;/p&gt;

Error Case:  non-existent file:

    &gt;&gt;&gt; import markdown
    &gt;&gt;&gt; text = """
    ... Text of the gist:
    ... [:gist: 4747847 doesntexist.py]
    ... """
    &gt;&gt;&gt; html = markdown.markdown(text, ['gist'])
    &gt;&gt;&gt; print(html)
    &lt;p&gt;Text of the gist:
    &lt;div class="gist"&gt;
    &lt;script src="https://gist.github.com/4747847.js?file=doesntexist.py"&gt;&lt;/script&gt;
    &lt;noscript&gt;&lt;!-- WARNING: Received a 404 response from Gist URL: \
    https://gist.githubusercontent.com/raw/4747847/doesntexist.py --&gt;&lt;/noscript&gt;
    &lt;/div&gt;
    &lt;/p&gt;

'''
from __future__ import unicode_literals, print_function
import warnings
from markdown.extensions import Extension
from markdown.inlinepatterns import Pattern
from markdown.util import AtomicString
from markdown.util import etree

try:
    import requests
except ImportError:
    requests = None  # NOQA

GIST_JS_URL = "https://gist.github.com/{0}.js"
GIST_FILE_JS_URL = "https://gist.github.com/{0}.js?file={1}"
GIST_RAW_URL = "https://gist.githubusercontent.com/raw/{0}"
GIST_FILE_RAW_URL = "https://gist.githubusercontent.com/raw/{0}/{1}"

GIST_MD_RE = r'\[:gist:\s*(?P&lt;gist_id&gt;\d+)(?:\s*(?P&lt;filename&gt;.+?))?\s*\]'
GIST_RST_RE = r'(?m)^\.\.\s*gist::\s*(?P&lt;gist_id&gt;\d+)(?:\s*(?P&lt;filename&gt;.+))\s*$'


class GistFetchException(Exception):
    '''Raised when attempt to fetch content of a Gist from github.com fails.'''
    def __init__(self, url, status_code):
        Exception.__init__(self)
        self.message = 'Received a {0} response from Gist URL: {1}'.format(
            status_code, url)


class GistPattern(Pattern):
    """ InlinePattern for footnote markers in a document's body text. """

    def __init__(self, pattern, configs):
        Pattern.__init__(self, pattern)

    def get_raw_gist_with_filename(self, gist_id, filename):
        url = GIST_FILE_RAW_URL.format(gist_id, filename)
        resp = requests.get(url)

        if not resp.ok:
            raise GistFetchException(url, resp.status_code)

        return resp.text

    def get_raw_gist(self, gist_id):
        url = GIST_RAW_URL.format(gist_id)
        resp = requests.get(url)

        if not resp.ok:
            raise GistFetchException(url, resp.status_code)

        return resp.text

    def handleMatch(self, m):
        gist_id = m.group('gist_id')
        gist_file = m.group('filename')

        gist_elem = etree.Element('div')
        gist_elem.set('class', 'gist')
        script_elem = etree.SubElement(gist_elem, 'script')

        if requests:
            noscript_elem = etree.SubElement(gist_elem, 'noscript')

            try:
                if gist_file:
                    script_elem.set('src', GIST_FILE_JS_URL.format(
                        gist_id, gist_file))
                    raw_gist = (self.get_raw_gist_with_filename(
                        gist_id, gist_file))

                else:
                    script_elem.set('src', GIST_JS_URL.format(
                        gist_id))
                    raw_gist = (self.get_raw_gist(gist_id))

                # Insert source as &lt;pre/&gt; within &lt;noscript&gt;
                pre_elem = etree.SubElement(noscript_elem, 'pre')
                pre_elem.text = AtomicString(raw_gist)

            except GistFetchException as e:
                warnings.warn(e.message)
                warning_comment = etree.Comment(' WARNING: {0} '.format(e.message))
                noscript_elem.append(warning_comment)

        else:
            warnings.warn('"requests" package not installed.  '
                          'Please install to add inline gist source.')

        return gist_elem


class GistExtension(Extension):
    def __init__(self, configs={}):
        # set extension defaults
        self.config = {}

        # Override defaults with user settings
        for key, value in configs:
            self.setConfig(key, value)

    def extendMarkdown(self, md, md_globals):
        gist_md_pattern = GistPattern(GIST_MD_RE, self.getConfigs())
        gist_md_pattern.md = md
        md.inlinePatterns.add('gist', gist_md_pattern, "&lt;not_strong")

        gist_rst_pattern = GistPattern(GIST_RST_RE, self.getConfigs())
        gist_rst_pattern.md = md
        md.inlinePatterns.add('gist-rst', gist_rst_pattern, "&gt;gist")

        md.registerExtension(self)


def makeExtension(configs=None):
    return GistExtension(configs)

if __name__ == '__main__':
    import doctest

    # Silence user warnings thrown by tests:
    with warnings.catch_warnings(record=True):
        doctest.testmod(optionflags=(doctest.NORMALIZE_WHITESPACE +
                                     doctest.REPORT_NDIFF))
</pre>
</noscript>
</div>

<p>I'll be sending a push request shortly to get this integrated into Nikola.  Thanks to Roberto Alsina for already <code>gist</code> support to reStructuredText posts in Nikola.</p>
<p><em>Update: <a href="https://github.com/ralsina/nikola/pull/380">Pull request accepted</a>!</em></p>
    </div>
    </article>
    <article class="h-entry post-text">
    <header>
        <h1 class="p-name entry-title"><a href="posts/confluence-numbered-heading-bookmarklet.html" class="u-url">Confluence numbered heading bookmarklet</a></h1>
        <div class="metadata">
            <p class="dateline">Posted: <a href="posts/confluence-numbered-heading-bookmarklet.html" rel="bookmark"><time class="published dt-published" datetime="2013-01-20T19:42:27+00:00" itemprop="datePublished" title="Publication date">2013-01-20 19:42</time></a></p>
        </div>
    </header>
    <div class="e-content entry-content">
    <p>This bookmarklet adds hierarchical section numbers to the section headers on the current confluence page. Note that it does not permanently change the content of the page; it only transforms the displayed HTML until the page is re-loaded. One of these days I'll figure out how to get this to work as a <a href="http://userscripts.org/">user script</a>.</p>
<p><a href="javascript:%28function%28%29%2520%7Bfunction%2520addSectionNumber%2520%28elem%2C%2520sectionNumber%2C%2520parentSection%2C%2520level%29%2520%7Bvar%2520sectionNumberStr%2520%3D%2520%2527%2527%3Bvar%2520sectionSpan%3Bif%2520%28level%2520%3E%25201%29%2520%7BsectionNumberStr%2520%3D%2520parentSection%2520%2B%2520%2527.%2527%2520%2B%2520sectionNumber%3B%7D%2520else%2520if%2520%28level%2520%3E%25200%29%2520%7BsectionNumberStr%2520%3D%2520sectionNumber.toString%28%29%3B%7Dif%2520%28level%2520%3E%25200%2520%26%26%2520jQuery%28elem%29.find%28%2527.section-number%2527%29.length%2520%3D%3D%3D%25200%2520%29%2520%7BsectionSpan%2520%3D%2520jQuery%28%2527%3Cspan%2520class%3D%2522section-number%2522%3E%2527%29.text%28sectionNumberStr%2520%2B%2520%2527%2520%2527%29%3BjQuery%28elem%29.prepend%28sectionSpan%29%3B%7Dif%2520%28%2520level%2520%3D%3D%3D%25200%2520%29%2520%7BjQuery%28elem%29.find%28%2527h1%2527%29.each%28%2520function%28index%2C%2520element%29%2520%7BaddSectionNumber%28element%2C%2520%28index%2520%2B%25201%29%2C%2520sectionNumberStr%2C%2520%28level%2520%2B%25201%29%29%3B%7D%29%3B%7D%2520else%2520if%2520%28%2520level%2520%3C%25206%2520%29%2520%7BjQuery%28elem%29.nextUntil%28%2527h%2527%2520%2B%2520level%2C%2520%2527h%2527%2520%2B%2520level%2520%2B%2520%2527%2Ch%2527%2520%2B%2520%28level%2520%2B%25201%29%29.each%28%2520function%28index%2C%2520element%29%2520%7BaddSectionNumber%28element%2C%2520%28index%2520%2B%25201%29%2C%2520sectionNumberStr%2C%2520%28level%2520%2B%25201%29%29%3B%7D%29%3B%7Dreturn%3B%7DaddSectionNumber%28jQuery%28%2527%23main-content%2527%29.first%28%29%2C%25200%2C%2520%2527%2527%2C%25200%29%3B%7D%29%28%29%3B">Confluence numbered section header bookmarklet</a></p>
<p>Source:</p>
<p>
</p>
<div class="gist">
<script src="https://gist.github.com/4582903.js"></script>
<noscript>
<pre>(function() {
    function addSectionNumber (elem, sectionNumber, parentSection, level) {
        var sectionNumberStr = '';
        var sectionSpan;

        if (level &gt; 1) {
            sectionNumberStr = parentSection + '.' + sectionNumber;
        } else if (level &gt; 0) {
            sectionNumberStr = sectionNumber.toString();
        }

        if (level &gt; 0 &amp;&amp; jQuery(elem).find('.section-number').length === 0 ) {
            sectionSpan = jQuery('&lt;span class="section-number"&gt;').text(sectionNumberStr + ' ');
            jQuery(elem).prepend(sectionSpan);
        }

        if ( level === 0 ) {
            jQuery(elem).find('h1').each( function(index, element) {
                addSectionNumber(element, (index + 1), sectionNumberStr, (level + 1));
            });
        } else if ( level &lt; 6 ) {
            jQuery(elem).nextUntil('h' + level, 'h' + level + ',h' + (level + 1)).each( function(index, element) {
                addSectionNumber(element, (index + 1), sectionNumberStr, (level + 1));
            });
        }

        return;
    }

    addSectionNumber(jQuery('#main-content').first(), 0, '', 0);
})();

</pre>
</noscript>
</div>

    </div>
    </article>
    <article class="h-entry post-text">
    <header>
        <h1 class="p-name entry-title"><a href="posts/oneis3com.html" class="u-url">oneis3.com</a></h1>
        <div class="metadata">
            <p class="dateline">Posted: <a href="posts/oneis3com.html" rel="bookmark"><time class="published dt-published" datetime="2013-01-12T23:26:58+00:00" itemprop="datePublished" title="Publication date">2013-01-12 23:26</time></a></p>
        </div>
    </header>
    <div class="e-content entry-content">
    <p>Today I set up a new coding blog on <a href="http://www.oneis3.com">oneis3.com</a>.  I've tinkered in the past with Blogger and Tumblr, but this time I decided to go with a different solution which gives me more control of my content.  This site is generated using <a href="http://nikola.ralsina.com.ar">Nikola</a>, a static site generator implemented in Python.  Hosting is provided via <a href="http://pages.github.com">Github Pages</a> (see the <a href="https://github.com/mrabbitt/mrabbitt.github.com">mrabbitt.github.com repo</a>).</p>
<p>I've been writing lots of little Python scripts and JavaScript bookmarklets lately which I hope to share here.  Perhaps some <a href="http://grails.org">Grails</a>/<a href="http://groovy.codehaus.org">Groovy</a>/Java discoveries from my day job will also find there way here.</p>
    </div>
    </article>
    <article class="h-entry post-text">
    <header>
        <h1 class="p-name entry-title"><a href="posts/python-script-to-download-splunk-documentation-pdfs.html" class="u-url">Python Script to download Splunk Documentation PDFs</a></h1>
        <div class="metadata">
            <p class="dateline">Posted: <a href="posts/python-script-to-download-splunk-documentation-pdfs.html" rel="bookmark"><time class="published dt-published" datetime="2012-11-20T16:33:00+00:00" itemprop="datePublished" title="Publication date">2012-11-20 16:33</time></a></p>
        </div>
    </header>
    <div class="e-content entry-content">
    <p>
</p>
<div class="gist">
<script src="https://gist.github.com/4121269.js"></script>
<noscript>
<pre>#!/usr/bin/env python
'''
Script to download all PDF files for a particular version of Splunk documentation.

Requirements:
    requests:  http://docs.python-requests.org
    beautifulsoup4:  http://www.crummy.com/software/BeautifulSoup/

(pip install -U requests beautifulsoup4)

Author:  Michael Rabbitt (https://github.com/mrabbitt)
'''
from __future__ import unicode_literals, print_function
import os.path
import shutil
import re
import sys
import tempfile
import requests
from bs4 import BeautifulSoup

manual_link_regex = re.compile(r'^/Documentation/Splunk/([\d.]+)/([^/]+)/(.+)$')
filename_regex = re.compile(r'filename="([^"]+)"')

def getDownloadFileName(response, default_name):
    '''Determines file name from a response object based on its headers
    Rerverts to `default_name` if no name is suggested by the response headers.'''
    if response.headers.has_key('content-disposition'):
        match = filename_regex.match(response.headers['content-disposition'])
        if match:
            return match.group(1)
    return default_name

def main(download_directory, target_version):
    response = requests.get('http://docs.splunk.com/Documentation/Splunk/{0}'.format(target_version))
    page = BeautifulSoup(response.text)
    manual_links = [div.find('a') for div in page.find_all('div', class_='manualmodule')]

    for manual_link in manual_links:
        match = manual_link_regex.match(manual_link.attrs['href'])
        doc_description = manual_link.text.strip()
        (version, section, docname) =  match.groups()

        pdf_url = 'http://docs.splunk.com/index.php?title=Documentation:Splunk:{0}:{1}:{2}&amp;action=pdfbook'.format(section, docname, version)
        print('Downloading "{0}" from &lt;{1}&gt;...'.format(doc_description, pdf_url))
        pdf_response = requests.get(pdf_url)

        file_name = getDownloadFileName(pdf_response, 'Splunk-{0}-{1}.pdf'.format(version, section))

        with tempfile.NamedTemporaryFile(suffix=file_name, delete=False) as temp_file:
            temp_file.write(pdf_response.content)

            target_path = os.path.join(download_directory, file_name)
            print('Moving temporary file to {0}'.format(target_path))
            shutil.move(temp_file.name, target_path)

    print('Complete')

if __name__ == '__main__':
    if len(sys.argv) == 3:
        download_directory = sys.argv[1]
        target_version = sys.argv[2] if len(sys.argv) == 3 else 'latest'

        if os.path.isdir(download_directory):
            main(download_directory, target_version)
        else:
            print('No such directory: {0}'.format(download_directory), file=sys.stderr)

    else:
        print('''Usage: {0} PATH_TO_DOWNLOAD_DIR VERSION'''.format(os.path.basename(__file__)), file=sys.stderr)</pre>
</noscript>
</div>

    </div>
    </article>
    <article class="h-entry post-text">
    <header>
        <h1 class="p-name entry-title"><a href="posts/open-in-sourcetree-from-intellij-idea.html" class="u-url">Open in SourceTree from IntelliJ IDEA</a></h1>
        <div class="metadata">
            <p class="dateline">Posted: <a href="posts/open-in-sourcetree-from-intellij-idea.html" rel="bookmark"><time class="published dt-published" datetime="2012-07-05T12:11:00+00:00" itemprop="datePublished" title="Publication date">2012-07-05 12:11</time></a></p>
        </div>
    </header>
    <div class="e-content entry-content">
    <p>I'm quite fond of <a href="http://www.sourcetreeapp.com/">SourceTree</a> for managing Git repositories (it does Mercurial as well).  SourceTree comes with an <code>stree</code> command to open repositories from the command line.  I wanted to set up an <a href="http://www.jetbrains.com/idea/webhelp/external-tools.html">external tool in IntelliJ IDEA</a> to the repo containing the current source file, <code>stree</code> only works if you call it without any arguments with a current working directory of the root level of a repo, or if you pass the path to the root level of a repo as an argument.  This is fine if you have only a single Git source root in your IntelliJ project:  You can just use call <code>stree</code> directly with the <code>$ProjectFileDir$</code> macro as a parameter.  But if you have multiple modules in your project with different Git source roots, it gets more difficult.  I tried using the <code>$ModuleFileDir$</code> macro, but this seems to the directory where the <code>.iml</code> file for the module is stored, which is not the source root of the module.</p>
<p>So, I ended up writing a small wrapper for <code>stree</code> which can take the path to any file or directory within a Git or Mercurial repo as an argument and invokes <code>stree</code> with the path to the root of the repo:</p>
<p>
</p>
<div class="gist">
<script src="https://gist.github.com/3051104.js"></script>
<noscript>
<pre>#!/bin/bash -e

getRepoRoot()
{
    local target=$1
    if [ -d "${target}" ] ; then
        cd "${target}"
    elif [ -f "${target}" ] ; then
        cd "$(dirname ${target})"
    fi

    echo $(git rev-parse --show-toplevel 2&gt;/dev/null || hg root 2&gt;/dev/null)
}

STREE_EXE='stree'
if ! type "${STREE_EXE}" ; then
    if [ -x '/Applications/SourceTree.app/Contents/Resources/stree' ] ; then
        STREE_EXE='/Applications/SourceTree.app/Contents/Resources/stree'
    fi
fi

repo_root_path=$(getRepoRoot "${1:-${PWD}}")
"$STREE_EXE" "${repo_root_path}"
</pre>
</noscript>
</div>

    </div>
    </article>
    <article class="h-entry post-text">
    <header>
        <h1 class="p-name entry-title"><a href="posts/diff-ing-zip-files-with-filemerge.html" class="u-url">Diff-ing .zip files with FileMerge</a></h1>
        <div class="metadata">
            <p class="dateline">Posted: <a href="posts/diff-ing-zip-files-with-filemerge.html" rel="bookmark"><time class="published dt-published" datetime="2010-12-13T10:36:00+00:00" itemprop="datePublished" title="Publication date">2010-12-13 10:36</time></a></p>
        </div>
    </header>
    <div class="e-content entry-content">
    <p>This isn't particularly elegant, but you can use the FileMerge application that comes with Mac OS X developer tools to compare the contents of zip files using a custom filter.</p>
<p>Create a script <code>~/bin/zip_filemerge_filter.bash</code> with contents:</p>
<pre class="code literal-block">##
#  List the size, CR-32 checksum, and file path of each file in a zip archive,
#  sorted in order by file path.
##
unzip -v -l "<span class="cp">${</span><span class="mi">1</span><span class="cp">}</span>" | cut -c 1-9,59-,49-57 | sort -k3
exit $?
Make the script executable (chmod +x ~/bin/zip_filemerge_filter.bash).
</pre>


<p>Open FileMerge, open the Preferences, and go to the "Filters" tab. Add an item to the list with:</p>
<ul>
<li>Extension: <code>zip</code> <em>(I've also added the filer for <code>.jar</code> and <code>.war</code> files.)</em>
</li>
<li>Filter: <code>~/bin/zip_filemerge_filter.bash $(FILE)</code>
</li>
<li>Display: <em>Filtered</em>
</li>
<li>Apply: <em>No</em>
</li>
</ul>
<p>Then use FileMerge (or the command line <code>opendiff</code> wrapper) to compare two .zip files.</p>
<p>This won't let you diff the contents of files within the zip archives, but will let you quickly see which files appear within one only archive and which files exist in both but have different content (i.e. different size and/or checksum).</p>
<p>(<em>Cross-posted on
<a href="http://stackoverflow.com/questions/587442/is-there-a-safe-way-to-run-a-diff-on-two-zip-compressed-files/4429169#4429169">StackOverflow</a> and <a href="http://michaelrabbitt.blogspot.com/2010/12/diff-ing-zip-files-with-filemerge.html">my old blogger blog</a>.</em>)</p>
    </div>
    </article>
</div>







    </div>
    </div>
    <!--End of body content-->
</div>
<div class="footerbox">
    Contents © 2010-2014 Michael Rabbitt - Powered by <a href="http://getnikola.com">Nikola</a>
    
</div>

            <script src="assets/js/jquery.min.js"></script>
            <script src="assets/js/bootstrap.min.js"></script>
        <script src="assets/js/jquery.colorbox-min.js"></script>
    

    <script>jQuery("a.image-reference").colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script>
    

<script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37668928-1']);
    _gaq.push(['_trackPageview']);

    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www')
            + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
</script>


</body>
</html>
